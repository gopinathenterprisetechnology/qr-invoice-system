<!DOCTYPE html>
<html>
<head>
  <title>Invoice Verification</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="card">
  <h2>Invoice Verification</h2>
  <div id="invoiceData">Loading...</div>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const inv = params.get("inv");

if(!inv){
  document.getElementById("invoiceData").innerHTML =
  "<span style='color:red;'>Invalid QR ❌</span>";
} else {

fetch("invoices/" + inv + ".json")
.then(res => {
  if(!res.ok) throw new Error("Not Found");
  return res.json();
})
.then(data => {

let itemsHTML = "";

data.items.forEach(item => {
  itemsHTML += `
  <tr>
    <td>${item.name}</td>
    <td>${item.colour}</td>
    <td>${item.qty}</td>
    <td>₹ ${item.rate}</td>
    <td>₹ ${item.amount}</td>
  </tr>`;
});

document.getElementById("invoiceData").innerHTML = `
<p style="color:green;"><b>Verified ✓</b></p>

<p><b>Shop:</b> ${data.shop.name}</p>
<p><b>Invoice No:</b> ${data.invoice.number}</p>
<p><b>Date:</b> ${data.invoice.date}</p>
<p><b>Payment:</b> ${data.invoice.payment_type}</p>

<hr>

<p><b>Customer:</b> ${data.customer.name}</p>
<p><b>Address:</b> ${data.customer.address}</p>
<p><b>Mobile:</b> ${data.customer.mobile}</p>

<hr>

<table border="1" width="100%" cellspacing="0" cellpadding="5">
<tr>
<th>Item</th>
<th>Colour</th>
<th>Qty</th>
<th>Rate</th>
<th>Amount</th>
</tr>
${itemsHTML}
</table>

<hr>

<p><b>Total:</b> ₹ ${data.total.total_amount}</p>
<p><b>Paid:</b> ₹ ${data.total.paid}</p>
<p><b>Due:</b> ₹ ${data.total.due}</p>
`;

})
.catch(() => {
document.getElementById("invoiceData").innerHTML =
"<span style='color:red;'>Invoice Not Found ❌</span>";
});
}
</script>

</body>
</html>
