<!DOCTYPE html>
<html>
<head>
<title>Invoice Verification</title>
<style>
body{
  font-family: Arial;
  background:#f5f5f5;
}
.bill{
  width:800px;
  margin:20px auto;
  background:white;
  padding:20px;
  border:2px solid black;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border:1px solid black;
  padding:6px;
  text-align:center;
}
.right{
  text-align:right;
}
.bold{
  font-weight:bold;
}
.section{
  margin-top:10px;
}
</style>
</head>
<body>
<div class="bill" id="invoiceData">
Loading Invoice...
</div>

 <script>
function generateQR(data) {

  const netAmount = data.total.net;
  const invoiceNo = data.invoice.number;

  const customerName = data.customer.name || "";
  const customerMobile = data.customer.mobile || "";

  const upiID = "boism-8001901640@boi";  
  const name = "GOPINATH ENTERPRISE";

  const noteText = `Invoice-${invoiceNo} | ${customerName} | ${customerMobile}`;

  const upiURL = `upi://pay?pa=${upiID}&pn=${encodeURIComponent(name)}&am=${netAmount}&cu=INR&tn=${encodeURIComponent(noteText)}`;

  const qrURL = `https://api.qrserver.com/v1/create-qr-code/?size=95x95&data=${encodeURIComponent(upiURL)}`;

  document.getElementById("paymentQR").src = qrURL;
}
</script>
  
<script>
const params = new URLSearchParams(window.location.search);
let invoiceNo = params.get("inv");

if(invoiceNo){
  invoiceNo = invoiceNo.trim();
}

console.log("Invoice Param:", invoiceNo);
if(!invoiceNo){
 document.getElementById("invoiceData").innerHTML="Invoice Not Found ‚ùå";
}
else{
  console.log("Invoice No:", invoiceNo);
console.log("Fetching:", "invoices/" + invoiceNo + ".json");

console.log("FETCH URL:", "https://gopinathenterprisetechnology.github.io/qr-invoice-system/invoices/" + invoiceNo + ".json");

fetch("invoices/" + invoiceNo + ".json")

.then(response => response.json())


.then(data=>{  
console.log("DATA:", data);
let itemsHTML = "";
if (data.items && Array.isArray(data.items)) {

data.items.forEach((item,index)=>{

let subDetails = "";

let model  = item.model || item.model_no || "";
let colour = item.colour || item.color || "";
let ram    = item.ram || item.ram_size || "";
let rom    = item.rom || item.storage || "";
let imei1  = item.imei1 || item.imei_1 || "";
let imei2  = item.imei2 || item.imei_2 || "";

if(model)  subDetails += `<div style="font-size:11px;">Model No: ${model}</div>`;
if(colour) subDetails += `<div style="font-size:11px;">Colour: ${colour}</div>`;
if(ram)    subDetails += `<div style="font-size:11px;">RAM: ${ram}</div>`;
if(rom)    subDetails += `<div style="font-size:11px;">ROM: ${rom}</div>`;
if(imei1)  subDetails += `<div style="font-size:11px;">IMEI 1: ${imei1}</div>`;
if(imei2)  subDetails += `<div style="font-size:11px;">IMEI 2: ${imei2}</div>`;

itemsHTML += `
<tr>
<td>${index+1}</td>
<td style="text-align:left;">
<b>${item.name || ""}</b>
${subDetails}
</td>
<td>${item.qty || ""}</td>
<td>${item.mrp || ""}</td>
<td>${item.rate || ""}</td>
<td>${item.amount || ""}</td>
</tr>
`;
});

} else {
   console.log("Items not found in JSON");
}


  
document.getElementById("invoiceData").innerHTML = `



<div style="background:#1e3a8a; color:white; padding:20px; border-radius:6px;">

  <div style="display:flex; align-items:center;">
<!-- Left Logo -->
<div style="width:150px; text-align:left;">
<img src="logo-left.png" 
     style="height:80px; margin-left:-10px; margin-top:10px;">
</div>

    <!-- Center Shop Details -->
    <div style="flex:1; text-align:center;">


<!-- Full Width Brand Logo Box -->
<div style="
  background:white;
  padding:6px 10px;          /* ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶Æ padding */
  border-radius:6px;         /* ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ curve */
  margin-bottom:8px;
  width:100%;
  box-sizing:border-box;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:18px;
">


  <!-- Example Logos (Replace with your PNG files) -->
  <img src="apple.png" style="height:28px;">
  <img src="samsung.png" style="height:28px;">
  <img src="vivo.png" style="height:28px;">
  <img src="oppo.png" style="height:28px;">
<img src="nokia.png" style="height:28px;">
  <img src="xiomi.png" style="height:28px;">
<img src="motorola.png" style="height:28px;">
</div>
    
      <h2 style="margin:0;">GOPINATH ENTERPRISE & TECHNOLOGY</h2>
      <p style="margin:2px 0; font-weight:bold;">CYBER CAFE & MOBILE SHOP</p>
      <p style="margin:2px 0;">
        All Types of Mobile, Accessories, Headphones, Earbuds, Neckband Sales & Services
      </p>
      <p style="margin:2px 0;">
        Dakshin Rasulpur, Arambagh, Hooghly, West Bengal - 712413
      </p>
    </div>

    <!-- Right Logo -->
    <div style="width:110px; text-align:right;">
      <img src="logo-right.png" style="height:90px;">
    </div>

  </div>

  <!-- Email Left | Mobile Right -->
  <div style="display:flex; justify-content:space-between; margin-top:10px; font-size:14px;">
    <div>
      Email: gopinathenterprisetechnology@gmail.com
    </div>
    <div>
      Contact No : 9339225562 / 8001901640
    </div>
  </div>
</div>   <!-- üî¥ THIS CLOSES BLUE HEADER -->

<div style="text-align:center; margin:15px 0 8px 0;">
  <span style="color:red; font-weight:bold; font-size:30px; letter-spacing:1px;">
    INVOICE
  </span>
</div>

                
  <div style="border:2px solid black; padding:10px; margin-top:10px;">

  <div style="display:flex; justify-content:space-between; font-weight:bold;">

    <div>
      Invoice No: ${data.invoice.number}
    </div>

    <div style="text-align:center;">
      Payment Mode: ${data.invoice.payment_mode}
    </div>

    <div style="text-align:right;">
      Date: ${data.invoice.date}
    </div>

  </div>

</div>                 
    



 <div style="border:2px solid black; padding:10px; margin-top:10px;">

<div class="section">
<b>Customer Name :</b> ${data.customer.name}<br>
<b>Address :</b> ${data.customer.address}<br>
<b>Place of Supply :</b> ${data.customer.place_of_supply}<br>
<b>Contact No :</b> ${data.customer.mobile}
</div>
</div>
<br>

<table>
<tr>
<th>Sl No</th>
<th>Description</th>
<th>Qty</th>
<th>MRP</th>
<th>Rate</th>
<th>Amount</th>
</tr>
${itemsHTML}
</table>
<br>

<table>
<tr>
<td class="right bold">Total Amount :</td>
<td class="right">${data.total.total_amount}</td>
</tr>
<tr>
<td class="right bold"> Round off:</td>
<td class="right">${data.total.round_off}</td>
</tr>
<tr>
<td class="right bold">Net Amount :</td>
<td class="right">${data.total.net}</td>
</tr>
<tr>
<td class="right bold">Due Amount :</td>
<td class="right">${data.total.due}</td>
</tr>
<tr>
<td class="right bold">Paid Amount :</td>
<td class="right">${data.total.paid}</td>
</tr>
</table>
<br>
<div class="section">
<b>Total Amount Rupees In Words:</b> ${data.total.amount_in_words}
</div>

<div class="section">
<b>Description:</b> ${data.description}</div>

<br>

<div style="display:flex; width:100%; margin-top:20px;">

  <!-- LEFT COLUMN -->
  <div style="width:50%;">

    <!-- Terms Box -->
    <div style="border:2px solid black; padding:10px;">
      <b style="font-size:15px;">TERMS & CONDITIONS:</b><br>
      1. Goods once sold not taken back.<br>
      2. Warranty of all items covered by the principal.<br>
      3. Payment 100% against delivery and installation.<br>
      4. Warranty not covered in case of physical or internal damage.
    </div>

    <!-- Customer Signature -->
    <div style="border-left:2px solid black; border-right:2px solid black; border-bottom:2px solid black; padding:10px; text-align:center;">
      
      <b>CUSTOMER SIGNATURE</b>
      <br><br><br><br><br>
    </div>

  </div>


  <!-- RIGHT COLUMN -->
  <div style="width:50%;">

    <!-- Bank Details + QR -->
    <div style="border:2px solid black; padding:10px; display:flex; justify-content:space-between; align-items:center;">

      <!-- Bank Details -->
      <div style="width:65%;">
        <b>Bank Account Details:</b><br>
        Bank Name: Bank of India<br>
        A/C Name: <span style="font-size:13px;">GOPINATH ENTERPRISE</span><br>
        A/C No: 425420110000328<br>
        A/C Type: Current<br>
        IFSC: BKID0004254
      </div>
      <!-- QR -->
<div style="width:30%; text-align:center;">
  <b>Scan & Pay</b><br>
  <img id="paymentQR" style="height:110px;">
</div>

    </div>

    <!-- Authorised Signature -->
    <div style="border-left:2px solid black; border-right:2px solid black; border-bottom:2px solid black; padding:10px; text-align:center;">
      <b>GOPINATH ENTERPRISE & TECHNOLOGY</b><br><br><br><br>
      <b>AUTHORISED SIGNATURE</b>
    </div>

  </div>

</div>

      
`;
  
console.log("QR Calling...");
  generateQR(data);
})
.catch((error)=>{
  console.log("ERROR FOUND:", error);
  document.getElementById("invoiceData").innerHTML="Invoice Not Found ‚ùå";
});

}
</script>
</body>
</html>
